{% load static %}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Sign In - ApplyWizz</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
</head>
<body class="bg-light">

<div class="container py-5">
    <div class="col-md-4 mx-auto card p-4 shadow">
        <h3 class="text-center mb-4">Log In</h3>

        <div id="step1">
            <label>Mobile Number</label>
            <input type="text" id="mobile" class="form-control mb-3" placeholder="Enter mobile number">
            <!-- <button id="sendOtpBtn" class="btn btn-success w-100">Send OTP</button> -->
             <button id="sendOtpBtn" class="btn btn-success w-100" onclick="window.location.href='/upload_resume';">
    Send OTP
</button>

        </div>

        <div id="step2" style="display:none;">
            <label>Enter OTP</label>
            <input type="text" id="otp" class="form-control mb-3" placeholder="Enter 4-digit OTP">
            <button id="verifyOtpBtn" class="btn btn-primary w-100">Verify OTP</button>
            <!-- <button id="verifyOtpBtn" class="btn btn-primary w-100">Verify OTP</button> -->
        </div>

        <div id="message" class="mt-3 text-center"></div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$("#sendOtpBtn").click(function(){
    $.post("{% url 'send_otp' %}", {
        mobile: $("#mobile").val(),
        csrfmiddlewaretoken: '{{ csrf_token }}'
    }, function(data){
        $("#message").text(data.message).css("color", data.status === "success" ? "green" : "red");
        if(data.status === "success"){
            $("#step1").hide();
            $("#step2").show();
        }
    });
});

$("#verifyOtpBtn").click(function(){
    $.post("{% url 'verify_otp' %}", {
        mobile: $("#mobile").val(),
        otp: $("#otp").val(),
        csrfmiddlewaretoken: '{{ csrf_token }}'
    }, function(data){
        if(data.status === "success"){
            window.location.href = data.redirect_url;
        } else {
            $("#message").text(data.message).css("color","red");
        }
    });
});
</script>

</body>
</html>
